<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marura - Marura school </title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <h1>Marura Repentance and Holiness CHURCH</h1>
        <h2>Marura Main Altar </h2>
        <nav>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#attendance">Attendance</a></li>
                <li><a href="#homecell">Home Cell</a></li>
                <li><a href="#visitors">New Visitors</a></li>
                <li><a href="#gallery">Gallery</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <!--home-->
        <section id="home">
            <h3>About Us</h3>
            <p>Welcome to the Marura, where we believe in the transformative power of faith.</p>
            <h3>Bishops Details</h3>
            <p>Information about our bishops and their vision for the church.</p>
            <h3>Overseers</h3>
            <p>Details about the overseers and their roles in our community.</p>
        </section>

        <!-- Attendance-->
        <section id="attendance">
            <h3>Service Attendance</h3>
            <p>Please fill in your details to mark attendance for today's service:</p>
            <form id="attendanceForm">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>

                <label for="service">Select Service:</label>
                <select id="service" name="service" required>
                    <option value="Sunday Service">Sunday Service</option>
                    <option value="Home Cell">Home Cell</option>
                    <option value="Wednesday Prayers">Wednesday Prayers</option>
                    <option value="Saturday Cleaning">Saturday Cleaning</option>
                    <option value="Saturday Worship Practice">Saturday Worship Practice</option>
                </select>

                <label for="quantity">Number of People:</label>
                <input type="number" id="quantity" name="quantity" value="1" min="1" required>

                <label for="contactDetails">Do you have contact details?</label>
                <input type="checkbox" id="contactDetails">

                <div id="contactInputs" style="display: none;">
                    <label for="contact">Contact Details:</label>
                    <input type="tel" id="contact" name="contact" pattern="[0-9]{10}" maxlength="10">
                </div>

                <button type="submit">Submit Attendance</button>
            </form>

            <h3>Today's Attendance</h3>
            <p>Total number of attendees: <strong id="attendeeCount">0</strong></p>

            <!-- Attendance-->
            <table id="attendanceTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Name</th>
                        <th>Service</th>
                        <th>Number of People</th>
                        <th>Contact</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Attendance records -->
                </tbody>
            </table>

            <button id="downloadAttendance">Download Attendance as Excel</button>
            <button id="resetAttendance">Reset Attendance</button>
        </section>

        <!-- Home Cell-->
        <section id="homecell">
            <h3>Home Cell Location</h3>
            <p>Fill in the location where today's home cell service will be held:</p>
            <form id="homecellForm">
                <label for="homeLocation">Home Cell Location:</label>
                <input type="text" id="homeLocation" name="homeLocation" required>

                <label for="host">Host Name:</label>
                <input type="text" id="host" name="host" required>

                <label for="homeContactDetails">Do you have contact details?</label>
                <input type="checkbox" id="homeContactDetails">

                <div id="homeContactInputs" style="display: none;">
                    <label for="homeContact">Contact Details:</label>
                    <input type="tel" id="homeContact" name="homeContact" pattern="[0-9]{10}" maxlength="10">
                </div>

                <button type="submit">Submit Location</button>
            </form>

            <h3>Today's Home Cell List</h3>
            <table id="homecellTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Host</th>
                        <th>Location</th>
                        <th>Contact</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Home Cell records -->
                </tbody>
            </table>

            <button id="downloadHomeCell">Download Home Cell List</button>
            <button id="resetHomeCell">Reset Home Cell</button>
        </section>

        <!-- New Visitors -->
        <section id="visitors">
            <h3>New Visitors Registration</h3>
            <p>If you're visiting us for the first time, please fill in your details:</p>
            <form id="visitorForm">
                <label for="visitorName">Name:</label>
                <input type="text" id="visitorName" name="visitorName" required>

                <label for="visitorPhone">Phone Number:</label>
                <input type="tel" id="visitorPhone" name="visitorPhone" pattern="[0-9]{10}" maxlength="10" required>

                <label for="visitorAddress">Address:</label>
                <input type="text" id="visitorAddress" name="visitorAddress" required>

                <label for="visitorContactDetails">Do you have contact details?</label>
                <input type="checkbox" id="visitorContactDetails">

                <div id="visitorContactInputs" style="display: none;">
                    <label for="visitorContact">Contact Details:</label>
                    <input type="tel" id="visitorContact" name="visitorContact" pattern="[0-9]{10}" maxlength="10">
                </div>

                <button type="submit">Register</button>
            </form>

            <h3>Today's Visitors List</h3>
            <table id="visitorTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Name</th>
                        <th>Phone</th>
                        <th>Address</th>
                        <th>Contact</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Visitor records  -->
                </tbody>
            </table>

            <button id="downloadVisitors">Download Visitor List</button>
            <button id="resetVisitors">Reset Visitors</button>
        </section>

        <!-- Gallery Section -->
        <section id="gallery">
            <h3>Gallery Upload</h3>
            <p>Please enter the admin password to upload pictures:</p>
            <input type="password" id="adminPassword">
            <button id="validatePassword">Validate Password</button>

            <div id="uploadSection" style="display: none;">
                <h4>Upload Pictures</h4>
                <input type="file" id="pictureUpload" accept="image/*" multiple>
                <button id="uploadButton">Upload</button>
            </div>

            <h3>Uploaded Pictures</h3>
            <div id="uploadedPictures"></div>
            <button id="resetGallery">Reset Gallery</button>
        </section>

        <!-- Contact Section -->
        <section id="contact">
            <h3>Contact Us</h3>
            <p>For any inquiries, please reach out to us at our church office.</p>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Marura. All rights reserved.</p>
    </footer>


    <style>
        /* Styles for the webpage */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        header {
            background: #333;
            color: #fff;
            padding: 20px 0;
            text-align: center;
        }

        nav ul {
            list-style: none;
            padding: 0;
        }

        nav ul li {
            display: inline;
            margin: 0 15px;
        }

        nav ul li a {
            color: #fff;
            text-decoration: none;
        }

        main {
            padding: 20px;
        }

        section {
            margin-bottom: 40px;
            background: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table, th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }

        th {
            background: #333;
            color: #fff;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        footer {
            text-align: center;
            padding: 10px;
            background: #333;
            color: #fff;
            position: relative;
            bottom: 0;
            width: 100%;
        }

        @media (max-width: 600px) {
            nav ul li {
                display: block;
                margin: 10px 0;
            }

            section {
                padding: 15px;
            }
        }
    </style>
       <script>
        // JavaScript functionality
        const password = "admin"; // Set the admin password
        let attendanceList = JSON.parse(localStorage.getItem('attendanceList')) || [];
        let homeCellList = JSON.parse(localStorage.getItem('homeCellList')) || [];
        let visitorList = JSON.parse(localStorage.getItem('visitorList')) || [];
        let uploadedImages = JSON.parse(localStorage.getItem('uploadedImages')) || [];

        // Load attendance from local storage
        window.onload = function () {
            updateAttendanceTable();
            updateHomeCellTable();
            updateVisitorTable();
            updateUploadedImages();
            document.getElementById('attendanceForm').reset();
            document.getElementById('homecellForm').reset();
            document.getElementById('visitorForm').reset();
        };

        // Attendance Form Submission
        document.getElementById('attendanceForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const service = document.getElementById('service').value;
            const quantity = document.getElementById('quantity').value;
            const contact = document.getElementById('contactDetails').checked ? document.getElementById('contact').value : "N/A";

            // Check for duplicates
            if (attendanceList.some(entry => entry.name === name && entry.contact === contact && entry.service === service)) {
                alert("Duplicate entry detected.");
                return;
            }

            const newEntry = { name, service, quantity, contact };
            attendanceList.push(newEntry);
            localStorage.setItem('attendanceList', JSON.stringify(attendanceList));
            updateAttendanceTable();
            document.getElementById('attendanceForm').reset();
        });

        // Update Attendance Table
        function updateAttendanceTable() {
            const tbody = document.querySelector('#attendanceTable tbody');
            tbody.innerHTML = '';
            attendanceList.forEach((entry, index) => {
                const row = `<tr>
                                <td>${index + 1}</td>
                                <td>${entry.name}</td>
                                <td>${entry.service}</td>
                                <td>${entry.quantity}</td>
                                <td>${entry.contact}</td>
                            </tr>`;
                tbody.innerHTML += row;
            });
            document.getElementById('attendeeCount').innerText = attendanceList.length;
        }

        // Home Cell Form Submission
        document.getElementById('homecellForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const homeLocation = document.getElementById('homeLocation').value;
            const host = document.getElementById('host').value;
            const homeContact = document.getElementById('homeContactDetails').checked ? document.getElementById('homeContact').value : "N/A";

            const newHomeCell = { host, location: homeLocation, contact: homeContact };

            // Check for duplicates
            if (homeCellList.some(entry => entry.host === host && entry.location === homeLocation && entry.contact === homeContact)) {
                alert("Duplicate home cell entry detected.");
                return;
            }

            homeCellList.push(newHomeCell);
            localStorage.setItem('homeCellList', JSON.stringify(homeCellList));
            updateHomeCellTable();
            document.getElementById('homecellForm').reset();
        });

        // Update Home Cell Table
        function updateHomeCellTable() {
            const tbody = document.querySelector('#homecellTable tbody');
            tbody.innerHTML = '';
            homeCellList.forEach((entry, index) => {
                const row = `<tr>
                                <td>${index + 1}</td>
                                <td>${entry.host}</td>
                                <td>${entry.location}</td>
                                <td>${entry.contact}</td>
                            </tr>`;
                tbody.innerHTML += row;
            });
        }

        // Visitor Form Submission
        document.getElementById('visitorForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const visitorName = document.getElementById('visitorName').value;
            const visitorPhone = document.getElementById('visitorPhone').value;
            const visitorAddress = document.getElementById('visitorAddress').value;
            const visitorContact = document.getElementById('visitorContactDetails').checked ? document.getElementById('visitorContact').value : "N/A";

            const newVisitor = { name: visitorName, phone: visitorPhone, address: visitorAddress, contact: visitorContact };

            // Check for duplicates
            if (visitorList.some(entry => entry.name === visitorName && entry.phone === visitorPhone && entry.address === visitorAddress)) {
                alert("Duplicate visitor entry detected.");
                return;
            }

            visitorList.push(newVisitor);
            localStorage.setItem('visitorList', JSON.stringify(visitorList));
            updateVisitorTable();
            document.getElementById('visitorForm').reset();
        });

        // Update Visitor Table
        function updateVisitorTable() {
            const tbody = document.querySelector('#visitorTable tbody');
            tbody.innerHTML = '';
            visitorList.forEach((entry, index) => {
                const row = `<tr>
                                <td>${index + 1}</td>
                                <td>${entry.name}</td>
                                <td>${entry.phone}</td>
                                <td>${entry.address}</td>
                                <td>${entry.contact}</td>
                            </tr>`;
                tbody.innerHTML += row;
            });
        }

        // Validate Admin Password
        document.getElementById('validatePassword').addEventListener('click', function () {
            const inputPassword = document.getElementById('adminPassword').value;
            if (inputPassword === password) {
                document.getElementById('uploadSection').style.display = 'block';
                alert("Password validated! You can now upload pictures.");
            } else {
                alert("Invalid password.");
            }
        });

        // Upload Pictures
        document.getElementById('uploadButton').addEventListener('click', function () {
            const files = document.getElementById('pictureUpload').files;
            for (let i = 0; i < files.length; i++) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    uploadedImages.push(e.target.result);
                    localStorage.setItem('uploadedImages', JSON.stringify(uploadedImages));
                    updateUploadedImages();
                };
                reader.readAsDataURL(files[i]);
            }
        });

        // Update Uploaded Images Display
        function updateUploadedImages() {
            const container = document.getElementById('uploadedPictures');
            container.innerHTML = '';
            uploadedImages.forEach((imageSrc, index) => {
                const img = `<img src="${imageSrc}" alt="Uploaded Image" style="width: 150px; height: auto; margin: 5px;">`;
                container.innerHTML += img;
            });
        }

        // Reset Functions with Password
        function resetData(dataType) {
            const confirmPassword = prompt(`Please enter the admin password to reset the ${dataType}:`);
            if (confirmPassword === password) {
                switch (dataType) {
                    case 'attendance':
                        attendanceList = [];
                        localStorage.removeItem('attendanceList');
                        updateAttendanceTable();
                        alert("Attendance reset successfully.");
                        break;
                    case 'home cell':
                        homeCellList = [];
                        localStorage.removeItem('homeCellList');
                        updateHomeCellTable();
                        alert("Home cell reset successfully.");
                        break;
                    case 'visitors':
                        visitorList = [];
                        localStorage.removeItem('visitorList');
                        updateVisitorTable();
                        alert("Visitors reset successfully.");
                        break;
                    case 'gallery':
                        uploadedImages = [];
                        localStorage.removeItem('uploadedImages');
                        updateUploadedImages();
                        alert("Gallery reset successfully.");
                        break;
                }
            } else {
                alert("Invalid password.");
            }
        }

        document.getElementById('downloadAttendance').addEventListener('click', function () {
            const confirmPassword = prompt("Please enter the admin password to download the attendance list:");
            if (confirmPassword === password) {
                // Convert attendance list to CSV format
                const csvContent = "data:text/csv;charset=utf-8," 
                    + attendanceList.map(e => Object.values(e).join(",")).join("\n");
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "attendance_list.csv");
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert("Invalid password.");
            }
        });

        document.getElementById('downloadHomeCell').addEventListener('click', function () {
            const confirmPassword = prompt("Please enter the admin password to download the home cell list:");
            if (confirmPassword === password) {
                const csvContent = "data:text/csv;charset=utf-8," 
                    + homeCellList.map(e => Object.values(e).join(",")).join("\n");
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "home_cell_list.csv");
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert("Invalid password.");
            }
        });

        document.getElementById('downloadVisitors').addEventListener('click', function () {
            const confirmPassword = prompt("Please enter the admin password to download the visitor list:");
            if (confirmPassword === password) {
                const csvContent = "data:text/csv;charset=utf-8," 
                    + visitorList.map(e => Object.values(e).join(",")).join("\n");
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "visitor_list.csv");
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert("Invalid password.");
            }
        });

        document.getElementById('resetAttendance').addEventListener('click', function () {
            resetData('attendance');
        });

        document.getElementById('resetHomeCell').addEventListener('click', function () {
            resetData('home cell');
        });

        document.getElementById('resetVisitors').addEventListener('click', function () {
            resetData('visitors');
        });

        document.getElementById('resetGallery').addEventListener('click', function () {
            resetData('gallery');
        });

        // Dynamic Input for Contact Details
        document.getElementById('contactDetails').addEventListener('change', function () {
            document.getElementById('contactInputs').style.display = this.checked ? 'block' : 'none';
        });

        document.getElementById('homeContactDetails').addEventListener('change', function () {
            document.getElementById('homeContactInputs').style.display = this.checked ? 'block' : 'none';
        });

        document.getElementById('visitorContactDetails').addEventListener('change', function () {
            document.getElementById('visitorContactInputs').style.display = this.checked ? 'block' : 'none';
        });
    </script>
 
</body>

</html>
